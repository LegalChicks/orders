<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Legal Chicks Poultry Farm</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #2e7d32; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background: #f4f4f4; }
    .total-box { margin-top: 20px; font-size: 18px; font-weight: bold; }
    form.checkout { margin-top: 30px; padding: 20px; border: 1px solid #ccc; border-radius: 10px; background: #fafafa; }
    form.checkout label { display: block; margin: 10px 0 5px; font-weight: bold; }
    form.checkout input, form.checkout select, form.checkout textarea {
      width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px;
    }
    form.checkout button {
      margin-top: 15px; padding: 12px; background: #2e7d32; color: #fff;
      font-size: 16px; font-weight: bold; border: none; border-radius: 5px;
      cursor: pointer;
    }
    form.checkout button:hover { background: #1b5e20; }
    .summary-line { margin-top: 6px; }
  </style>
</head>
<body>
  <h1>üêì Welcome to Legal Chicks Poultry Farm</h1>
  <p>Order your fresh poultry directly from our farm. Input the quantity you want for each product below.</p>

  <form id="orderForm">
    <table>
      <thead>
        <tr>
          <th>Product</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Subtotal</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Rhode Island Red</td>
          <td>‚Ç±350</td>
          <td><input type="number" min="0" value="0" class="qty" data-price="350"></td>
          <td class="subtotal">‚Ç±0</td>
        </tr>
        <tr>
          <td>Black Australorp</td>
          <td>‚Ç±380</td>
          <td><input type="number" min="0" value="0" class="qty" data-price="380"></td>
          <td class="subtotal">‚Ç±0</td>
        </tr>
        <tr>
          <td>Fertile Eggs (per dozen)</td>
          <td>‚Ç±300</td>
          <td><input type="number" min="0" value="0" class="qty" data-price="300"></td>
          <td class="subtotal">‚Ç±0</td>
        </tr>
      </tbody>
    </table>
  </form>

  <div class="total-box">
    <div class="summary-line">Total Quantity: <span id="totalQty">0</span></div>
    <div class="summary-line">Subtotal: <span id="subtotal">‚Ç±0</span></div>
    <div class="summary-line">Discount: <span id="discount">‚Ç±0</span></div>
    <div class="summary-line">Final Total: <span id="total">‚Ç±0</span></div>
  </div>

  <!-- Checkout form -->
  <form class="checkout" id="checkoutForm" method="POST" action="https://formspree.io/f/mwprporn">
    <!-- Replace action above with your Formspree/Getform endpoint -->
    <h2>Checkout</h2>

    <label for="name">Full Name</label>
    <input type="text" id="name" name="name" required placeholder="Juan Dela Cruz">

    <label for="phone">Contact Number</label>
    <input type="text" id="phone" name="phone" required placeholder="+63 9XX XXX XXXX">

    <label for="location">Location</label>
    <input type="text" id="location" name="location" required placeholder="Barangay, City">

    <label for="method">Order Method</label>
    <select id="method" name="method" required>
      <option value="pickup">Farm Pickup</option>
      <option value="delivery">Delivery (limited area)</option>
    </select>

    <label for="notes">Notes / Special Requests</label>
    <textarea id="notes" name="notes" rows="3" placeholder="Preferred pickup time, etc."></textarea>

    <input type="hidden" name="order_details" id="order_details">
    <input type="hidden" name="order_total" id="order_total">

    <button type="submit">Submit Order</button>
  </form>

  <script>
    const inputs = document.querySelectorAll(".qty");
    const subtotalEl = document.getElementById("subtotal");
    const discountEl = document.getElementById("discount");
    const totalEl = document.getElementById("total");
    const totalQtyEl = document.getElementById("totalQty");
    const orderDetailsInput = document.getElementById("order_details");
    const orderTotalInput = document.getElementById("order_total");

    function updateTotals() {
      let subtotal = 0;
      let totalQty = 0;
      let details = [];

      document.querySelectorAll("tbody tr").forEach(row => {
        const qty = parseInt(row.querySelector(".qty").value) || 0;
        const price = parseInt(row.querySelector(".qty").dataset.price);
        const rowSubtotal = qty * price;

        row.querySelector(".subtotal").textContent = "‚Ç±" + rowSubtotal.toLocaleString();

        if (qty > 0) {
          details.push(`${row.cells[0].textContent}: ${qty} pcs ‚Äî ‚Ç±${rowSubtotal.toLocaleString()}`);
        }

        subtotal += rowSubtotal;
        totalQty += qty;
      });

      let discount = 0;
      let discountNote = "";
      if (totalQty >= 30) {
        discount = subtotal * 0.05;
        discountNote = ` (for bulk order of ${totalQty} items)`;
      }

      const finalTotal = subtotal - discount;

      subtotalEl.textContent = "‚Ç±" + subtotal.toLocaleString();
      discountEl.textContent = discount > 0 
        ? `-‚Ç±${discount.toLocaleString()}${discountNote}` 
        : "‚Ç±0";
      totalEl.textContent = "‚Ç±" + finalTotal.toLocaleString();
      totalQtyEl.textContent = totalQty;

      // Generate timestamp in GMT+8 (Philippines)
      const now = new Date();
      const timestamp = now.toLocaleString("en-PH", { timeZone: "Asia/Manila" });

      // Save details to hidden inputs (with subtotal & discount breakdown)
      details.push(`Subtotal (before discount): ‚Ç±${subtotal.toLocaleString()}`);
      if (discount > 0) {
        details.push(`Discount Applied: -‚Ç±${discount.toLocaleString()}${discountNote}`);
      } else {
        details.push(`No Discount Applied`);
      }
      details.push(`Final Total: ‚Ç±${finalTotal.toLocaleString()}`);
      details.push(`Order Timestamp (Philippines): ${timestamp}`);

      orderDetailsInput.value = details.join("\n");
      orderTotalInput.value = "‚Ç±" + finalTotal.toLocaleString();
    }

    inputs.forEach(input => {
      input.addEventListener("input", updateTotals);
    });

    updateTotals();
  </script>
</body>
</html>
